# Solar Circuit Designer (太陽光発電所 回路設計支援ツール)

**現在のデプロイ状況**: 
メインアプリケーションは `index.html` (旧 `preview.html`) に集約されています。このファイルは単独で動作するHTMLファイルであり（React, Tailwind, SheetJSをCDN経由で読み込み）、GitHub Pages等の静的ホスティングサービスにそのまま配置して動作可能です。

## 機能概要

### 1. 入力・設定
- **パネル仕様入力**:
  - Voc, Vmp, Isc, Imp, 温度係数などの詳細入力
  - **プリセット機能**: 主要メーカーのパネルプリセット（56種以上）
  - **カスタム保存**: ユーザー定義のパネル仕様をブラウザ（LocalStorage）に保存・呼び出し可能
  - 安全性警告の表示（仕様確認の注意喚起）
- **PCS仕様入力**:
  - 複数台のPCS構成に対応（HUAWEI SUN2000シリーズ等のプリセット搭載）
  - **仕様コピー**: PCS追加時に直前のPCS仕様を自動コピーし、入力の手間を軽減
  - 回路数、MPPT数、各種電圧・電流制限値の設定
- **設置条件**:
  - 想定最低気温の設定（Voc温度補正用）
  - 目標過積載率の設定（デフォルト145%）

### 2. 自動計算・シミュレーション
- **ストリング設計**: MPPT動作範囲と最大電圧制約に基づいた最適直列数の算出
- **温度補正**: 最低気温時のVoc上昇を考慮した安全性チェック
- **過積載率計算**: PV容量とPCS容量に基づく過積載率の算出
- **電流チェック**:
  - ストリング電流 vs PCS許容電流
  - 短絡電流 vs PCS許容短絡電流
  - MPPT単位の電流制限チェック

### 3. 結果表示・出力
- **設計サマリー**: PV総容量、PCS総定格、全体過積載率、未配置パネル数の表示
- **適正設計ガイド**:
  - 電圧設計のベストゾーン判定
  - 電流設計（並列接続時のピークカットや短絡電流制約）の詳細解説と判定
- **回路割付表 (Matrix)**:
  - PCSごとの回路使用状況をマトリクス表示
  - **MPPT区切り表示**: PCSのMPPT構成に基づき、MPPTごとの区切り線を強調表示（横線のみ）
  - **ヘリオスモード**: MPPT内の直列数不整合を視覚的にチェック（赤色強調）する機能
  - マウス操作によるパネル枚数の微調整（左クリック増/右クリック減）
- **Excel出力**:
  - 「設計サマリー」と「回路割付詳細」の2シートを含むExcelファイルを生成・ダウンロード

## ファイル構成

- `index.html`: メインアプリケーション。これを開くだけでアプリが利用可能です。
- `index.old.html`: バックアップファイル。

## 開発・利用方法

本ツールはサーバーサイド処理を必要とせず、ブラウザ上で全ての計算が完結します。
`index.html` をブラウザで開くか、Webサーバー上に配置して利用してください。

### 制限事項
- 並列ストリング（Y端子等を用いた1回路への複数ストリング物理接続）のシミュレーションは、電流チェックの簡易判定のみ対応しています。
- 計算ロジックは「電圧制約内での最大枚数」を優先して割り当てます。

## 履歴
- 2025.12.05: 「ヘリオス」機能追加（MPPT不整合チェック）
- 2025.12.05: MPPT区切り線の視覚的強調機能を追加
- 2025.12.05: Excel出力機能の実装
- 2025.12.05: UI改善（入力欄強調、ボタン追加、警告文言追加など）
- 2025.12.05: バグ修正（数値変換エラーによるホワイトスクリーン問題の解消）
