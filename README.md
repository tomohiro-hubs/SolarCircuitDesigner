# Solar Circuit Designer (太陽光発電所 回路設計支援ツール)

Webブラウザ上で動作する、太陽光発電所のストリング構成・回路割付設計ツールです。
React + Tailwind CSS で構築されており、サーバサイド処理を必要とせず、単一のHTMLファイル (`index.html`) として動作します。

## 主な機能

### 1. パネル・PCS仕様の入力と管理
*   **プリセット機能**: 主要メーカーのソーラーパネル、PCSの仕様データをプリセットとして内蔵。
*   **カスタム登録**: ユーザー独自のパネル・PCS仕様を入力し、ブラウザ(LocalStorage)に保存可能。
*   **PCS構成管理**: 複数のPCSを追加・削除し、大規模な発電所構成にも対応。
*   **システム概要**: DC/AC総容量、過積載率をリアルタイムで概算表示。

### 2. 自動設計シミュレーション
*   **ストリング設計**: 最低気温時の開放電圧(Voc)上昇、MPPT電圧範囲を考慮した最適な直列数を自動計算。
*   **回路割付**: PCSの回路数に合わせてパネルを自動的に割り当て（ラウンドロビン方式）。
*   **制約チェック**:
    *   電圧制約 (Voc < MaxInputVoltage, Vmp within MPPT range)
    *   電流制約 (Imp < MaxInputCurrent, Isc < MaxIsc)
    *   過積載率チェック

### 3. インタラクティブな回路割付表 (Matrix)
*   **可視化**: PCSごとの回路割付状況を表形式で表示。MPPTごとの区切りを視覚的に強調。
*   **手動調整**: セルをクリックして直列数を微調整可能。
    *   **左クリック**: +1 (またはブラシ適用)
    *   **右クリック**: -1 (またはブラシ解除)
    *   **Shift + 左クリック**: 0枚（クリア）
    *   **Alt + 左クリック**: スポイト機能（クリックしたセルの枚数をブラシにコピー）
*   **ヘリオスモード**: 同一MPPT内で直列数が不揃いな箇所を赤色で警告表示（未入力回路は除外）。

### 4. 結果出力
*   **Excelエクスポート**: 設計サマリー、詳細な回路割付表を含むExcelファイル(.xlsx)を出力可能。
*   **設計ガイド**: 電圧・電流設計の妥当性を判定するガイドパネルを表示。

## 技術スタック
*   **Frontend**: React 18, Tailwind CSS (CDN)
*   **Logic**: JavaScript (ES6+)
*   **Utils**: SheetJS (xlsx), FontAwesome

## ファイル構成
*   `index.html`: アプリケーション本体（これ1つで動作します）
*   `index.old.html`: バックアップ

## 使用方法
1.  `index.html` をWebブラウザ（Chrome, Edge等）で開きます。
2.  左側のパネルで「パネル仕様」「PCS構成」「設置条件」を入力・選択します。
3.  「設計シミュレーション実行」ボタンを押します。
4.  右側に設計結果、回路割付表が表示されます。
5.  必要に応じて割付表をクリックして微調整を行い、Excel出力を実行してください。

## 最新の更新 (v1.3.1 - 2025.12.05)
*   **UI改善**: 左右パネルへのスクロールボタン追加、システム概要カードの追加。
*   **UX向上**: 右クリックでのブラシ解除機能、Shift+Clickでのクリア機能の実装。
*   **不具合修正**: 画面が白くなる問題(Ref参照エラー)の修正、テーブル列順序の固定化。

## 開発者向け情報
本ツールは `Babel Standalone` を使用してブラウザ内でJSXをトランスパイルしています。
本番環境で高速化・軽量化が必要な場合は、Create React App や Vite 等を使用したビルド環境への移行を推奨します。
